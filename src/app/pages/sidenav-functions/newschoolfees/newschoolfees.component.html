<div class="container">
  <h4 class="text-success pt-5 pb-1">Set School Fees</h4>

  <!-- Step 1: Form for setting school fees -->
  <div *ngIf="step === 1">
    <div class="row headeroptions p-1 mb-4">
      <!-- Year, Term, Level Dropdowns -->
      <div class="col-md-2 col-6">
        <label for="year">Year</label>
        <select id="year" class="form-select" [(ngModel)]="myyear">
          <option *ngFor="let year of years" [value]="year">{{ year }}</option>
        </select>
      </div>
      <div class="col-md-2 col-6">
        <label for="term">Term</label>
        <select id="term" class="form-select" [(ngModel)]="myterm">
          <option *ngFor="let term of terms" [value]="term">{{ term }}</option>
        </select>
      </div>
      <div class="col-md-2 col-6">
        <label for="level">Class</label>
        <select id="level" class="form-select" [(ngModel)]="mylevel">
          <option *ngFor="let level of levels" [value]="level">{{ level }}</option>
        </select>
      </div>
      <div class="col-md-2 col-6">
        <button class="btn btn-success" (click)="createschoolfees()">Next step</button>
      </div>
    </div>
  </div>

  <!-- Step 2: Fee Details Form -->
  <div *ngIf="step === 2">
    <h2 class="text-success pt-5">
      <button class="btn btn-info" (click)="addDetail()"> <i class="bi bi-plus"></i> Add Fees Detail</button>
    </h2>

    <!-- List of added items above the total -->
    <ul class="list-group mb-4">
      <li *ngFor="let detail of schoolFeesDetails" class="list-group-item">
        <strong>{{ detail.item }}</strong> - {{ detail.description }}: <span class="text-danger">UgX {{ detail.amount | number:'1.0-0' }}</span>
      </li>
    </ul>

    <!-- Dynamic Fields for Fee Details -->
    <div *ngIf="isAddingDetail" class="row align-items-center mb-3">
      <div class="col-md-3">
        <input class="form-control" type="text" [(ngModel)]="currentDetail.item" placeholder="Item" />
      </div>
      <div class="col-md-3">
        <input class="form-control" type="text" [(ngModel)]="currentDetail.description" placeholder="Description" />
      </div>
      <div class="col-md-3">
        <input class="form-control" type="number" [(ngModel)]="currentDetail.amount" (change)="calculateTotal()" placeholder="Amount" />
      </div>
      <div class="col-md-3 d-flex justify-content-center">
        <button class="btn btn-sm btn-success m-1" (click)="addToList(currentDetail)">Add to List</button>
        <button class="btn btn-danger btn-sm m-1" (click)="cancelAddDetail()">Cancel</button>
      </div>
    </div>

    <!-- Display Total -->
    <h3>Total: <span class="text-secondary mx-1">UgX</span> <span class="text-danger"> {{ schoolFeesSetting.total | number:'1.0-0' }}</span> </h3>

    <button class="btn btn-primary" (click)="saveFees()">Save Fees</button>
  </div>
</div>
